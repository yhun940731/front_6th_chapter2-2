import{r as h,j as e,R as H,a as z}from"./client-DvaAtPIX.js";const J=t=>{const{isAdmin:s,cart:i,setIsAdmin:a,setDebouncedSearchTerm:r}=t,[u,c]=h.useState(0),[l,d]=h.useState("");return h.useEffect(()=>{const o=i.reduce((x,n)=>x+n.quantity,0);c(o)},[i]),h.useEffect(()=>{const o=setTimeout(()=>{r(l)},500);return()=>clearTimeout(o)},[l]),e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40 border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"SHOP"}),!s&&e.jsx("div",{className:"ml-8 flex-1 max-w-md",children:e.jsx("input",{type:"text",value:l,onChange:o=>d(o.target.value),placeholder:"상품 검색...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})})]}),e.jsxs("nav",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>a(!s),className:`px-3 py-1.5 text-sm rounded transition-colors ${s?"bg-gray-800 text-white":"text-gray-600 hover:text-gray-900"}`,children:s?"쇼핑몰로 돌아가기":"관리자 페이지로"}),!s&&e.jsxs("div",{className:"relative",children:[e.jsx("svg",{className:"w-6 h-6 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),i.length>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:u})]})]})]})})})};function Q(t){const{notifications:s,setNotifications:i}=t;return e.jsx("div",{className:"fixed top-20 right-4 z-50 space-y-2 max-w-sm",children:s.map(a=>e.jsxs("div",{className:`p-4 rounded-md shadow-md text-white flex justify-between items-center ${a.type==="error"?"bg-red-600":a.type==="warning"?"bg-yellow-600":"bg-green-600"}`,children:[e.jsx("span",{className:"mr-2",children:a.message}),e.jsx("button",{onClick:()=>i(r=>r.filter(u=>u.id!==a.id)),className:"text-white hover:text-gray-200",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},a.id))})}function U(){const[t,s]=h.useState(()=>{const n=localStorage.getItem("cart");if(n)try{return JSON.parse(n)}catch{return[]}return[]}),[i,a]=h.useState(null);h.useEffect(()=>{t.length>0?localStorage.setItem("cart",JSON.stringify(t)):localStorage.removeItem("cart")},[t]);const r=(n,m)=>{const f=o(n);let g=null;if(f<=0){g=new Error(`상품 "${n.name}"의 재고가 부족합니다.`);return}if(s(y=>{const j=y.find(b=>b.product.id===n.id);if(j){const b=j.quantity+1;return b>n.stock?(g=new Error(`상품 "${n.name}"의 재고는 ${n.stock}개까지만 가능합니다.`),y):y.map(N=>N.product.id===n.id?{...N,quantity:b}:N)}return[...y,{product:n,quantity:1}]}),g)throw g;m?.()},u=n=>{s(m=>m.filter(f=>f.product.id!==n))},c=(n,m)=>{s(f=>f.map(g=>g.product.id===n?{...g,quantity:m}:g))},l=n=>{a(n)},d=()=>{let n=0;return t.forEach(m=>{n+=m.product.price*m.quantity}),i&&(i.discountType==="amount"?n-=i.discountValue:n*=1-i.discountValue/100),Math.max(n,0)},o=n=>{const m=t.find(g=>g.product.id===n.id);return n.stock-(m?.quantity||0)};return{cart:t,selectedCoupon:i,addToCart:r,removeFromCart:u,updateQuantity:c,applyCoupon:l,calculateTotal:d,getRemainingStock:o,clearCart:()=>{s([]),a(null)}}}function _({couponForm:t,setCouponForm:s,onSubmit:i,onCancel:a,addNotification:r}){return e.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:e.jsxs("form",{onSubmit:i,className:"space-y-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-900",children:"새 쿠폰 생성"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"쿠폰명"}),e.jsx("input",{type:"text",value:t.name,onChange:u=>s({...t,name:u.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",placeholder:"신규 가입 쿠폰",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"쿠폰 코드"}),e.jsx("input",{type:"text",value:t.code,onChange:u=>s({...t,code:u.target.value.toUpperCase()}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm font-mono",placeholder:"WELCOME2024",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"할인 타입"}),e.jsxs("select",{value:t.discountType,onChange:u=>s({...t,discountType:u.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",children:[e.jsx("option",{value:"amount",children:"정액 할인"}),e.jsx("option",{value:"percentage",children:"정률 할인"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t.discountType==="amount"?"할인 금액":"할인율(%)"}),e.jsx("input",{type:"text",value:t.discountValue===0?"":t.discountValue,onChange:u=>{const{value:c}=u.target;(c===""||/^\d+$/.test(c))&&s({...t,discountValue:c===""?0:parseInt(c)})},onBlur:u=>{const c=parseInt(u.target.value)||0;t.discountType==="percentage"?c>100?(r("할인율은 100%를 초과할 수 없습니다","error"),s({...t,discountValue:100})):c<0&&s({...t,discountValue:0}):c>1e5?(r("할인 금액은 100,000원을 초과할 수 없습니다","error"),s({...t,discountValue:1e5})):c<0&&s({...t,discountValue:0})},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",placeholder:t.discountType==="amount"?"5000":"10",required:!0})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"취소"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700",children:"쿠폰 생성"})]})]})})}function G({coupons:t,onDeleteCoupon:s,onAddCoupon:i}){return e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[t.map(a=>e.jsx("div",{className:"relative bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-4 border border-indigo-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:a.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1 font-mono",children:a.code}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-white text-indigo-700",children:a.discountType==="amount"?`${a.discountValue.toLocaleString()}원 할인`:`${a.discountValue}% 할인`})})]}),e.jsx("button",{onClick:()=>s(a.code),className:"text-gray-400 hover:text-red-600 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})},a.code)),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 flex items-center justify-center hover:border-gray-400 transition-colors",children:e.jsxs("button",{onClick:i,className:"text-gray-400 hover:text-gray-600 flex flex-col items-center",children:[e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("p",{className:"mt-2 text-sm font-medium",children:"새 쿠폰 추가"})]})})]})}function K({coupons:t,showCouponForm:s,couponForm:i,setCouponForm:a,onAddCoupon:r,onDeleteCoupon:u,onSubmitCoupon:c,onCancelCoupon:l,addNotification:d}){return e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold",children:"쿠폰 관리"})}),e.jsxs("div",{className:"p-6",children:[e.jsx(G,{coupons:t,onDeleteCoupon:u,onAddCoupon:r}),s&&e.jsx(_,{couponForm:i,setCouponForm:a,onSubmit:c,onCancel:l,addNotification:d})]})]})}function X({productForm:t,setProductForm:s,editingProduct:i,onSubmit:a,onCancel:r,addNotification:u}){return e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("form",{onSubmit:a,className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:i==="new"?"새 상품 추가":"상품 수정"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"상품명"}),e.jsx("input",{type:"text",value:t.name,onChange:c=>s({...t,name:c.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"설명"}),e.jsx("input",{type:"text",value:t.description,onChange:c=>s({...t,description:c.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"가격"}),e.jsx("input",{type:"text",value:t.price===0?"":t.price,onChange:c=>{const{value:l}=c.target;(l===""||/^\d+$/.test(l))&&s({...t,price:l===""?0:parseInt(l)})},onBlur:c=>{const{value:l}=c.target;l===""?s({...t,price:0}):parseInt(l)<0&&(u("가격은 0보다 커야 합니다","error"),s({...t,price:0}))},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",placeholder:"숫자만 입력",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"재고"}),e.jsx("input",{type:"text",value:t.stock===0?"":t.stock,onChange:c=>{const{value:l}=c.target;(l===""||/^\d+$/.test(l))&&s({...t,stock:l===""?0:parseInt(l)})},onBlur:c=>{const{value:l}=c.target;l===""?s({...t,stock:0}):parseInt(l)<0?(u("재고는 0보다 커야 합니다","error"),s({...t,stock:0})):parseInt(l)>9999&&(u("재고는 9999개를 초과할 수 없습니다","error"),s({...t,stock:9999}))},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",placeholder:"숫자만 입력",required:!0})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"할인 정책"}),e.jsxs("div",{className:"space-y-2",children:[t.discounts.map((c,l)=>e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 p-2 rounded",children:[e.jsx("input",{type:"number",value:c.quantity,onChange:d=>{const o=[...t.discounts];o[l].quantity=parseInt(d.target.value)||0,s({...t,discounts:o})},className:"w-20 px-2 py-1 border rounded",min:"1",placeholder:"수량"}),e.jsx("span",{className:"text-sm",children:"개 이상 구매 시"}),e.jsx("input",{type:"number",value:c.rate*100,onChange:d=>{const o=[...t.discounts];o[l].rate=(parseInt(d.target.value)||0)/100,s({...t,discounts:o})},className:"w-16 px-2 py-1 border rounded",min:"0",max:"100",placeholder:"%"}),e.jsx("span",{className:"text-sm",children:"% 할인"}),e.jsx("button",{type:"button",onClick:()=>{const d=t.discounts.filter((o,x)=>x!==l);s({...t,discounts:d})},className:"text-red-600 hover:text-red-800",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},l)),e.jsx("button",{type:"button",onClick:()=>{s({...t,discounts:[...t.discounts,{quantity:10,rate:.1}]})},className:"text-sm text-indigo-600 hover:text-indigo-800",children:"+ 할인 추가"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"취소"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700",children:i==="new"?"추가":"수정"})]})]})})}function Y({products:t,formatPrice:s,onEditProduct:i,onDeleteProduct:a}){return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상품명"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"가격"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"재고"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"설명"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"작업"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(r=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:r.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s(r.price,r.id)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${r.stock>10?"bg-green-100 text-green-800":r.stock>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[r.stock,"개"]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:r.description||"-"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>i(r),className:"text-indigo-600 hover:text-indigo-900 mr-3",children:"수정"}),e.jsx("button",{onClick:()=>a(r.id),className:"text-red-600 hover:text-red-900",children:"삭제"})]})]},r.id))})]})})}function Z({products:t,showProductForm:s,editingProduct:i,productForm:a,setProductForm:r,formatPrice:u,onAddProduct:c,onEditProduct:l,onDeleteProduct:d,onSubmitProduct:o,onCancelProduct:x,addNotification:n}){return e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"상품 목록"}),e.jsx("button",{onClick:c,className:"px-4 py-2 bg-gray-900 text-white text-sm rounded-md hover:bg-gray-800",children:"새 상품 추가"})]})}),e.jsx(Y,{products:t,formatPrice:u,onEditProduct:l,onDeleteProduct:d}),s&&e.jsx(X,{productForm:a,setProductForm:r,editingProduct:i,onSubmit:o,onCancel:x,addNotification:n})]})}const F=[{id:"p1",name:"상품1",price:1e4,stock:20,discounts:[{quantity:10,rate:.1},{quantity:20,rate:.2}],description:"최고급 품질의 프리미엄 상품입니다."},{id:"p2",name:"상품2",price:2e4,stock:20,discounts:[{quantity:10,rate:.15}],description:"다양한 기능을 갖춘 실용적인 상품입니다.",isRecommended:!0},{id:"p3",name:"상품3",price:3e4,stock:20,discounts:[{quantity:10,rate:.2},{quantity:30,rate:.25}],description:"대용량과 고성능을 자랑하는 상품입니다."}],ee=[{name:"5000원 할인",code:"AMOUNT5000",discountType:"amount",discountValue:5e3},{name:"10% 할인",code:"PERCENT10",discountType:"percentage",discountValue:10}];function D(){const[t,s]=h.useState(()=>{const r=localStorage.getItem("coupons");if(r)try{return JSON.parse(r)}catch{return[]}return ee});return h.useEffect(()=>{localStorage.setItem("coupons",JSON.stringify(t))},[t]),{coupons:t,addCoupon:(r,u,c)=>{if(t.find(d=>d.code===r.code)){c?.();return}s(d=>[...d,r]),u?.()},removeCoupon:(r,u)=>{s(c=>c.filter(l=>l.code!==r)),u?.()}}}function M(){const[t,s]=h.useState(()=>{const d=localStorage.getItem("products");if(d)try{return JSON.parse(d)}catch{return[]}return F});return h.useEffect(()=>{localStorage.setItem("products",JSON.stringify(t))},[t]),{products:t,updateProduct:(d,o,x)=>{s(n=>n.map(m=>m.id===d?{...m,...o}:m)),x?.()},addProduct:(d,o)=>{const x={...d,id:`p${Date.now()}`};s(n=>[...n,x]),o?.()},deleteProduct:(d,o)=>{s(x=>x.filter(n=>n.id!==d)),o?.()},updateProductStock:(d,o)=>{s(x=>x.map(n=>n.id===d?{...n,stock:o}:n))},addProductDiscount:(d,o)=>{s(x=>x.map(n=>n.id===d?{...n,discounts:[...n.discounts||[],o]}:n))},removeProductDiscount:(d,o)=>{s(x=>x.map(n=>n.id===d?{...n,discounts:n.discounts?.filter((m,f)=>f!==o)}:n))}}}function te(t){const{getRemainingStock:s,setNotifications:i}=t,{coupons:a,addCoupon:r,removeCoupon:u}=D(),{products:c,addProduct:l,updateProduct:d,deleteProduct:o}=M(),[x,n]=h.useState(!1),[m,f]=h.useState("products"),[g,y]=h.useState(!1),[j,b]=h.useState(null),[N,w]=h.useState({name:"",price:0,stock:0,description:"",discounts:[]}),[T,L]=h.useState({name:"",code:"",discountType:"amount",discountValue:0}),I=(p,S)=>{if(S){const k=c.find(C=>C.id===S);if(k&&s(k)<=0)return"SOLD OUT"}return`${p.toLocaleString()}원`},v=h.useCallback((p,S="success")=>{const k=Date.now().toString();i(C=>[...C,{id:k,message:p,type:S}]),setTimeout(()=>{i(C=>C.filter(W=>W.id!==k))},3e3)},[]),V=()=>{b("new"),w({name:"",price:0,stock:0,description:"",discounts:[]}),y(!0)},$=p=>{o(p,()=>{v("상품이 삭제되었습니다.","success")})},A=()=>{b(null),w({name:"",price:0,stock:0,description:"",discounts:[]}),y(!1)},E=p=>{u(p,()=>{v("쿠폰이 삭제되었습니다.","success")})},B=p=>{p.preventDefault(),j&&j!=="new"?(d(j,N,()=>{v("상품이 수정되었습니다.","success")}),b(null)):l({...N,discounts:N.discounts},()=>{v("상품이 추가되었습니다.","success")}),w({name:"",price:0,stock:0,description:"",discounts:[]}),b(null),y(!1)},O=p=>{p.preventDefault(),r(T,()=>{v("쿠폰이 추가되었습니다.","success")},()=>{v("이미 존재하는 쿠폰 코드입니다.","error")}),L({name:"",code:"",discountType:"amount",discountValue:0}),n(!1)},R=p=>{b(p.id),w({name:p.name,price:p.price,stock:p.stock,description:p.description||"",discounts:p.discounts||[]}),y(!0)};return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"관리자 대시보드"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"상품과 쿠폰을 관리할 수 있습니다"})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>f("products"),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${m==="products"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"상품 관리"}),e.jsx("button",{onClick:()=>f("coupons"),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${m==="coupons"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"쿠폰 관리"})]})}),m==="products"?e.jsx(Z,{products:c,showProductForm:g,editingProduct:j,productForm:N,setProductForm:w,formatPrice:I,onAddProduct:V,onEditProduct:R,onDeleteProduct:$,onSubmitProduct:B,onCancelProduct:A,addNotification:v}):e.jsx(K,{coupons:a,showCouponForm:x,couponForm:T,setCouponForm:L,onAddCoupon:()=>n(!x),onDeleteCoupon:E,onSubmitCoupon:O,onCancelCoupon:()=>n(!1),addNotification:v})]})}function se(t){const{item:s,hasDiscount:i,discountRate:a,itemTotal:r,handleClickQuantity:u,removeFromCart:c}=t;return e.jsxs("div",{className:"border-b pb-3 last:border-b-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 flex-1",children:s.product.name}),e.jsx("button",{onClick:()=>c(s.product.id),className:"text-gray-400 hover:text-red-500 ml-2",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>u(s.product.id,s.quantity-1),className:"w-6 h-6 rounded border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:e.jsx("span",{className:"text-xs",children:"−"})}),e.jsx("span",{className:"mx-3 text-sm font-medium w-8 text-center",children:s.quantity}),e.jsx("button",{onClick:()=>u(s.product.id,s.quantity+1),className:"w-6 h-6 rounded border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:e.jsx("span",{className:"text-xs",children:"+"})})]}),e.jsxs("div",{className:"text-right",children:[i&&e.jsxs("span",{className:"text-xs text-red-500 font-medium block",children:["-",a,"%"]}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[Math.round(r).toLocaleString(),"원"]})]})]})]})}function ne(t){const{products:s,cart:i,updateQuantity:a,removeFromCart:r,calculateItemTotal:u,addNotification:c}=t,l=(d,o)=>{if(o<=0){r(d);return}const x=s.find(m=>m.id===d);if(!x)return;const n=x.stock;if(o>n){c(`재고는 ${n}개까지만 있습니다.`,"error");return}a(d,o)};return e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),"장바구니"]}),i.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),e.jsx("p",{className:"text-gray-500 text-sm",children:"장바구니가 비어있습니다"})]}):e.jsx("div",{className:"space-y-3",children:i.map(d=>{const o=u(d),x=d.product.price*d.quantity,n=o<x,m=n?Math.round((1-o/x)*100):0;return e.jsx(se,{item:d,hasDiscount:n,discountRate:m,itemTotal:o,handleClickQuantity:l,removeFromCart:r},d.product.id)})})]})}function re({coupons:t,selectedCoupon:s,onCouponSelect:i}){const a=r=>{const u=t.find(c=>c.code===r.target.value);i(u||null)};return e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"쿠폰 할인"}),e.jsx("button",{className:"text-xs text-blue-600 hover:underline",children:"쿠폰 등록"})]}),t.length>0&&e.jsxs("select",{className:"w-full text-sm border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500",value:s?.code||"",onChange:a,children:[e.jsx("option",{value:"",children:"쿠폰 선택"}),t.map(r=>e.jsxs("option",{value:r.code,children:[r.name," (",r.discountType==="amount"?`${r.discountValue.toLocaleString()}원`:`${r.discountValue}%`,")"]},r.code))]})]})}function ae({totals:t,onCompleteOrder:s}){const i=t.totalBeforeDiscount-t.totalAfterDiscount,a=i>0;return e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"결제 정보"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"상품 금액"}),e.jsxs("span",{className:"font-medium",children:[t.totalBeforeDiscount.toLocaleString(),"원"]})]}),a&&e.jsxs("div",{className:"flex justify-between text-red-500",children:[e.jsx("span",{children:"할인 금액"}),e.jsxs("span",{children:["-",i.toLocaleString(),"원"]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-t border-gray-200",children:[e.jsx("span",{className:"font-semibold",children:"결제 예정 금액"}),e.jsxs("span",{className:"font-bold text-lg text-gray-900",children:[t.totalAfterDiscount.toLocaleString(),"원"]})]})]}),e.jsxs("button",{onClick:s,className:"w-full mt-4 py-3 bg-yellow-400 text-gray-900 rounded-md font-medium hover:bg-yellow-500 transition-colors",children:[t.totalAfterDiscount.toLocaleString(),"원 결제하기"]}),e.jsx("div",{className:"mt-3 text-xs text-gray-500 text-center",children:e.jsx("p",{children:"* 실제 결제는 이루어지지 않습니다"})})]})}const ie=(t,s)=>{const{discounts:i}=t.product,{quantity:a}=t,r=i.reduce((c,l)=>a>=l.quantity&&l.rate>c?l.rate:c,0);return s.some(c=>c.quantity>=10)?Math.min(r+.05,.5):r},q=(t,s)=>{const{price:i}=t.product,{quantity:a}=t,r=ie(t,s);return Math.round(i*a*(1-r))},P=(t,s)=>{let i=0,a=0;return t.forEach(r=>{const u=r.product.price*r.quantity;i+=u,a+=q(r,t)}),s&&(s.discountType==="amount"?a=Math.max(0,a-s.discountValue):a=Math.round(a*(1-s.discountValue/100))),{totalBeforeDiscount:Math.round(i),totalAfterDiscount:Math.round(a)}},oe=(t,s)=>!(s<1e4&&t.discountType==="percentage");function ce(t){const{products:s,cart:i,coupons:a,updateQuantity:r,removeFromCart:u,clearCart:c,addNotification:l}=t,[d,o]=h.useState(null),x=h.useCallback(g=>{if(!g){o(null);return}const y=P(i).totalAfterDiscount;if(!oe(g,y)){l("percentage 쿠폰은 10,000원 이상 구매 시 사용 가능합니다.","error");return}o(g),l("쿠폰이 적용되었습니다.","success")},[l,i]),n=h.useCallback(()=>{const g=`ORD-${Date.now()}`;l(`주문이 완료되었습니다. 주문번호: ${g}`,"success"),c(),o(null)},[l,c]),m=P(i,d),f=h.useCallback(g=>q(g,i),[i]);return e.jsxs("div",{className:"sticky top-24 space-y-4",children:[e.jsx(ne,{products:s,cart:i,updateQuantity:r,removeFromCart:u,calculateItemTotal:f,addNotification:l}),i.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(re,{coupons:a,selectedCoupon:d,onCouponSelect:x}),e.jsx(ae,{totals:m,onCompleteOrder:n})]})]})}function le(t){const{product:s,price:i,remainingStock:a,handleAddToCart:r}=t;return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"aspect-square bg-gray-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-24 h-24 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),s.isRecommended&&e.jsx("span",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded",children:"BEST"}),s.discounts.length>0&&e.jsxs("span",{className:"absolute top-2 left-2 bg-orange-500 text-white text-xs px-2 py-1 rounded",children:["~",Math.max(...s.discounts.map(u=>u.rate))*100,"%"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-2",children:s.description}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:i}),s.discounts.length>0&&e.jsxs("p",{className:"text-xs text-gray-500",children:[s.discounts[0].quantity,"개 이상 구매시 할인 ",s.discounts[0].rate*100,"%"]})]}),e.jsxs("div",{className:"mb-3",children:[a<=5&&a>0&&e.jsxs("p",{className:"text-xs text-red-600 font-medium",children:["품절임박! ",a,"개 남음"]}),a>5&&e.jsxs("p",{className:"text-xs text-gray-500",children:["재고 ",a,"개"]})]}),e.jsx("button",{onClick:()=>r(s),disabled:a<=0,className:`w-full py-2 px-4 rounded-md font-medium transition-colors ${a<=0?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800"}`,children:a<=0?"품절":"장바구니 담기"})]})]})}function de(t){const{products:s,debouncedSearchTerm:i,addToCart:a,addNotification:r,getRemainingStock:u}=t,c=(o,x)=>{if(x){const n=s.find(m=>m.id===x);if(n&&u(n)<=0)return"SOLD OUT"}return`₩${o.toLocaleString()}`},l=o=>{try{a(o,()=>{r("장바구니에 담았습니다","success")})}catch(x){r(x instanceof Error?x.message:"알 수 없는 오류가 발생했습니다.","error")}},d=i?s.filter(o=>o.name.toLowerCase().includes(i.toLowerCase())||o.description&&o.description.toLowerCase().includes(i.toLowerCase())):s;return e.jsxs("section",{children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"전체 상품"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["총 ",s.length,"개 상품"]})]}),d.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsxs("p",{className:"text-gray-500",children:['"',i,'"에 대한 검색 결과가 없습니다.']})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(o=>{const x=u(o),n=c(o.price,o.id);return e.jsx(le,{product:o,price:n,remainingStock:x,handleAddToCart:l},o.id)})})]})}function ue(t){const{cart:s,debouncedSearchTerm:i,addToCart:a,updateQuantity:r,removeFromCart:u,clearCart:c,getRemainingStock:l,setNotifications:d}=t,{coupons:o}=D(),{products:x}=M(),n=h.useCallback((m,f="success")=>{const g=Date.now().toString();d(y=>[...y,{id:g,message:m,type:f}]),setTimeout(()=>{d(y=>y.filter(j=>j.id!==g))},3e3)},[]);return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsx(de,{products:x,debouncedSearchTerm:i,addToCart:a,addNotification:n,getRemainingStock:l})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx(ce,{products:x,cart:s,coupons:o,updateQuantity:r,removeFromCart:u,clearCart:c,addNotification:n})})]})}const xe=()=>{const{cart:t,addToCart:s,updateQuantity:i,removeFromCart:a,clearCart:r,getRemainingStock:u}=U(),[c,l]=h.useState(!1),[d,o]=h.useState([]),[x,n]=h.useState("");return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[d.length>0&&e.jsx(Q,{notifications:d,setNotifications:o}),e.jsx(J,{isAdmin:c,setIsAdmin:l,setDebouncedSearchTerm:n,cart:t}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 py-8",children:c?e.jsx(te,{getRemainingStock:u,setNotifications:o}):e.jsx(ue,{cart:t,debouncedSearchTerm:x,clearCart:r,updateQuantity:i,removeFromCart:a,addToCart:s,getRemainingStock:u,setNotifications:o})})]})};H.createRoot(document.getElementById("root")).render(e.jsx(z.StrictMode,{children:e.jsx(xe,{})}));
