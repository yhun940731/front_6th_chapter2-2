import{r as A,a as re,j as t,R as Ee}from"./client-DvaAtPIX.js";const $={},me=(e,s)=>e.unstable_is?e.unstable_is(s):s===e,xe=e=>"init"in e,X=e=>!!e.write,he=e=>"v"in e||"e"in e,U=e=>{if("e"in e)throw e.e;if(($?"production":void 0)!=="production"&&!("v"in e))throw new Error("[Bug] atom state is not initialized");return e.v},J=new WeakMap,fe=e=>{var s;return Q(e)&&!!((s=J.get(e))!=null&&s[0])},De=e=>{const s=J.get(e);s?.[0]&&(s[0]=!1,s[1].forEach(n=>n()))},be=(e,s)=>{let n=J.get(e);if(!n){n=[!0,new Set],J.set(e,n);const r=()=>{n[0]=!1};e.then(r,r)}n[1].add(s)},Q=e=>typeof e?.then=="function",ve=(e,s,n)=>{n.p.has(e)||(n.p.add(e),s.then(()=>{n.p.delete(e)},()=>{n.p.delete(e)}))},Y=(e,s,n)=>{const r=n(e),i="v"in r,a=r.v;if(Q(s))for(const c of r.d.keys())ve(e,s,n(c));r.v=s,delete r.e,(!i||!Object.is(a,r.v))&&(++r.n,Q(a)&&De(a))},pe=(e,s,n)=>{var r;const i=new Set;for(const a of((r=n.get(e))==null?void 0:r.t)||[])n.has(a)&&i.add(a);for(const a of s.p)i.add(a);return i},Me=Symbol(),Ie=(e=new WeakMap,s=new WeakMap,n=new WeakMap,r=new Set,i=new Set,a=new Set,c={},m=(h,...v)=>h.read(...v),u=(h,...v)=>h.write(...v),o=(h,v)=>{var N;return(N=h.unstable_onInit)==null?void 0:N.call(h,v)},l=(h,v)=>{var N;return(N=h.onMount)==null?void 0:N.call(h,v)},...g)=>{const h=g[0]||(d=>{if(($?"production":void 0)!=="production"&&!d)throw new Error("Atom is undefined or null");let b=e.get(d);return b||(b={d:new Map,p:new Set,n:0},e.set(d,b),o?.(d,Z)),b}),v=g[1]||(()=>{const d=[],b=y=>{try{y()}catch(f){d.push(f)}};do{c.f&&b(c.f);const y=new Set,f=y.add.bind(y);r.forEach(x=>{var p;return(p=s.get(x))==null?void 0:p.l.forEach(f)}),r.clear(),a.forEach(f),a.clear(),i.forEach(f),i.clear(),y.forEach(b),r.size&&N()}while(r.size||a.size||i.size);if(d.length)throw new AggregateError(d)}),N=g[2]||(()=>{const d=[],b=new WeakSet,y=new WeakSet,f=Array.from(r);for(;f.length;){const x=f[f.length-1],p=h(x);if(y.has(x)){f.pop();continue}if(b.has(x)){if(n.get(x)===p.n)d.push([x,p]);else if(($?"production":void 0)!=="production"&&n.has(x))throw new Error("[Bug] invalidated atom exists");y.add(x),f.pop();continue}b.add(x);for(const S of pe(x,p,s))b.has(S)||f.push(S)}for(let x=d.length-1;x>=0;--x){const[p,S]=d[x];let P=!1;for(const I of S.d.keys())if(I!==p&&r.has(I)){P=!0;break}P&&(T(p),O(p)),n.delete(p)}}),T=g[3]||(d=>{var b;const y=h(d);if(he(y)&&(s.has(d)&&n.get(d)!==y.n||Array.from(y.d).every(([k,z])=>T(k).n===z)))return y;y.d.clear();let f=!0;const x=()=>{s.has(d)&&(O(d),N(),v())},p=k=>{var z;if(me(d,k)){const ue=h(k);if(!he(ue))if(xe(k))Y(k,k.init,h);else throw new Error("no atom init");return U(ue)}const H=T(k);try{return U(H)}finally{y.d.set(k,H.n),fe(y.v)&&ve(d,y.v,H),(z=s.get(k))==null||z.t.add(d),f||x()}};let S,P;const I={get signal(){return S||(S=new AbortController),S.signal},get setSelf(){return($?"production":void 0)!=="production"&&!X(d)&&console.warn("setSelf function cannot be used with read-only atom"),!P&&X(d)&&(P=(...k)=>{if(($?"production":void 0)!=="production"&&f&&console.warn("setSelf function cannot be called in sync"),!f)try{return V(d,...k)}finally{N(),v()}}),P}},B=y.n;try{const k=m(d,p,I);return Y(d,k,h),Q(k)&&(be(k,()=>S?.abort()),k.then(x,x)),y}catch(k){return delete y.v,y.e=k,++y.n,y}finally{f=!1,B!==y.n&&n.get(d)===B&&(n.set(d,y.n),r.add(d),(b=c.c)==null||b.call(c,d))}}),q=g[4]||(d=>{const b=[d];for(;b.length;){const y=b.pop(),f=h(y);for(const x of pe(y,f,s)){const p=h(x);n.set(x,p.n),b.push(x)}}}),V=g[5]||((d,...b)=>{let y=!0;const f=p=>U(T(p)),x=(p,...S)=>{var P;const I=h(p);try{if(me(d,p)){if(!xe(p))throw new Error("atom not writable");const B=I.n,k=S[0];Y(p,k,h),O(p),B!==I.n&&(r.add(p),(P=c.c)==null||P.call(c,p),q(p));return}else return V(p,...S)}finally{y||(N(),v())}};try{return u(d,f,x,...b)}finally{y=!1}}),O=g[6]||(d=>{var b;const y=h(d),f=s.get(d);if(f&&!fe(y.v)){for(const[x,p]of y.d)if(!f.d.has(x)){const S=h(x);F(x).t.add(d),f.d.add(x),p!==S.n&&(r.add(x),(b=c.c)==null||b.call(c,x),q(x))}for(const x of f.d||[])if(!y.d.has(x)){f.d.delete(x);const p=W(x);p?.t.delete(d)}}}),F=g[7]||(d=>{var b;const y=h(d);let f=s.get(d);if(!f){T(d);for(const x of y.d.keys())F(x).t.add(d);if(f={l:new Set,d:new Set(y.d.keys()),t:new Set},s.set(d,f),(b=c.m)==null||b.call(c,d),X(d)){const x=()=>{let p=!0;const S=(...P)=>{try{return V(d,...P)}finally{p||(N(),v())}};try{const P=l(d,S);P&&(f.u=()=>{p=!0;try{P()}finally{p=!1}})}finally{p=!1}};i.add(x)}}return f}),W=g[8]||(d=>{var b;const y=h(d);let f=s.get(d);if(f&&!f.l.size&&!Array.from(f.t).some(x=>{var p;return(p=s.get(x))==null?void 0:p.d.has(d)})){f.u&&a.add(f.u),f=void 0,s.delete(d),(b=c.u)==null||b.call(c,d);for(const x of y.d.keys()){const p=W(x);p?.t.delete(d)}return}return f}),Le=[e,s,n,r,i,a,c,m,u,o,l,h,v,N,T,q,V,O,F,W],Z={get:d=>U(T(d)),set:(d,...b)=>{try{return V(d,...b)}finally{N(),v()}},sub:(d,b)=>{const f=F(d).l;return f.add(b),v(),()=>{f.delete(b),W(d),v()}}};return Object.defineProperty(Z,Me,{value:Le}),Z},qe=Ie,ge=be,je={};let Ve=0;function C(e,s){const n=`atom${++Ve}`,r={toString(){return(je?"production":void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof e=="function"?r.read=e:(r.init=e,r.read=Re,r.write=$e),s&&(r.write=s),r}function Re(e){return e(this)}function $e(e,s,n){return s(this,typeof n=="function"?n(e(this)):n)}function we(){return qe()}let R;function Oe(){return R||(R=we(),(je?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=R),globalThis.__JOTAI_DEFAULT_STORE__!==R&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),R}const Fe={},Ne=A.createContext(void 0);function ke(e){return A.useContext(Ne)||Oe()}function We({children:e,store:s}){const n=A.useRef(void 0);return!s&&!n.current&&(n.current=we()),A.createElement(Ne.Provider,{value:s||n.current},e)}const te=e=>typeof e?.then=="function",se=e=>{e.status||(e.status="pending",e.then(s=>{e.status="fulfilled",e.value=s},s=>{e.status="rejected",e.reason=s}))},Be=re.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(se(e),e)}),ee=new WeakMap,ye=(e,s)=>{let n=ee.get(e);return n||(n=new Promise((r,i)=>{let a=e;const c=o=>l=>{a===o&&r(l)},m=o=>l=>{a===o&&i(l)},u=()=>{try{const o=s();te(o)?(ee.set(o,n),a=o,o.then(c(o),m(o)),ge(o,u)):r(o)}catch(o){i(o)}};e.then(c(e),m(e)),ge(e,u)}),ee.set(e,n)),n};function ze(e,s){const{delay:n,unstable_promiseStatus:r=!re.use}={},i=ke(),[[a,c,m],u]=A.useReducer(l=>{const g=i.get(e);return Object.is(l[0],g)&&l[1]===i&&l[2]===e?l:[g,i,e]},void 0,()=>[i.get(e),i,e]);let o=a;if((c!==i||m!==e)&&(u(),o=i.get(e)),A.useEffect(()=>{const l=i.sub(e,()=>{if(r)try{const g=i.get(e);te(g)&&se(ye(g,()=>i.get(e)))}catch{}if(typeof n=="number"){setTimeout(u,n);return}u()});return u(),l},[i,e,n,r]),A.useDebugValue(o),te(o)){const l=ye(o,()=>i.get(e));return r&&se(l),Be(l)}return o}function w(e,s){const n=ke();return A.useCallback((...i)=>{if((Fe?"production":void 0)!=="production"&&!("write"in e))throw new Error("not writable atom");return n.set(e,...i)},[n,e])}function j(e,s){return[ze(e),w(e)]}const oe={},Ue=Symbol((oe?"production":void 0)!=="production"?"RESET":""),Ce=e=>typeof e?.then=="function";function Je(e=()=>{try{return window.localStorage}catch(n){(oe?"production":void 0)!=="production"&&typeof window<"u"&&console.warn(n);return}},s){var n;let r,i;const a={getItem:(u,o)=>{var l,g;const h=N=>{if(N=N||"",r!==N){try{i=JSON.parse(N,s?.reviver)}catch{return o}r=N}return i},v=(g=(l=e())==null?void 0:l.getItem(u))!=null?g:null;return Ce(v)?v.then(h):h(v)},setItem:(u,o)=>{var l;return(l=e())==null?void 0:l.setItem(u,JSON.stringify(o,void 0))},removeItem:u=>{var o;return(o=e())==null?void 0:o.removeItem(u)}},c=u=>(o,l,g)=>u(o,h=>{let v;try{v=JSON.parse(h||"")}catch{v=g}l(v)});let m;try{m=(n=e())==null?void 0:n.subscribe}catch{}return!m&&typeof window<"u"&&typeof window.addEventListener=="function"&&window.Storage&&(m=(u,o)=>{if(!(e()instanceof window.Storage))return()=>{};const l=g=>{g.storageArea===e()&&g.key===u&&o(g.newValue)};return window.addEventListener("storage",l),()=>{window.removeEventListener("storage",l)}}),m&&(a.subscribe=c(m)),a}const Qe=Je();function G(e,s,n=Qe,r){const i=C(s);return(oe?"production":void 0)!=="production"&&(i.debugPrivate=!0),i.onMount=c=>{c(n.getItem(e,s));let m;return n.subscribe&&(m=n.subscribe(e,c,s)),m},C(c=>c(i),(c,m,u)=>{const o=typeof u=="function"?u(c(i)):u;return o===Ue?(m(i,s),n.removeItem(e)):Ce(o)?o.then(l=>(m(i,l),n.setItem(e,l))):(m(i,o),n.setItem(e,o))})}const Ge=[{id:"p1",name:"상품1",price:1e4,stock:20,discounts:[{quantity:10,rate:.1},{quantity:20,rate:.2}],description:"최고급 품질의 프리미엄 상품입니다."},{id:"p2",name:"상품2",price:2e4,stock:20,discounts:[{quantity:10,rate:.15}],description:"다양한 기능을 갖춘 실용적인 상품입니다.",isRecommended:!0},{id:"p3",name:"상품3",price:3e4,stock:20,discounts:[{quantity:10,rate:.2},{quantity:30,rate:.25}],description:"대용량과 고성능을 자랑하는 상품입니다."}],Ke=[{name:"5000원 할인",code:"AMOUNT5000",discountType:"amount",discountValue:5e3},{name:"10% 할인",code:"PERCENT10",discountType:"percentage",discountValue:10}],L=G("products",Ge),D=G("coupons",Ke),_=G("cart",[]),ie=G("selectedCoupon",null),ne=(e,s)=>{const n=s.find(r=>r.product.id===e.id);return e.stock-(n?.quantity||0)},Ze=C(null,(e,s,n)=>{const r=e(_);if(ne(n,r)<=0)throw new Error(`상품 "${n.name}"의 재고가 부족합니다.`);const a=r.find(c=>c.product.id===n.id);if(a){const c=a.quantity+1;if(c>n.stock)throw new Error(`상품 "${n.name}"의 재고는 ${n.stock}개까지만 가능합니다.`);s(_,r.map(m=>m.product.id===n.id?{...m,quantity:c}:m))}else s(_,[...r,{product:n,quantity:1}])}),He=C(null,(e,s,n)=>{const r=e(_);s(_,r.filter(i=>i.product.id!==n))}),Xe=C(null,(e,s,{productId:n,quantity:r})=>{const i=e(_);s(_,i.map(a=>a.product.id===n?{...a,quantity:r}:a))}),Ye=C(null,(e,s)=>{s(_,[]),s(ie,null)}),et=C(null,(e,s,{productId:n,updates:r})=>{const i=e(L);s(L,i.map(a=>a.id===n?{...a,...r}:a))}),tt=C(null,(e,s,n)=>{const r=e(L),i={...n,id:`p${Date.now()}`};s(L,[...r,i])}),st=C(null,(e,s,n)=>{const r=e(L);s(L,r.filter(i=>i.id!==n))}),nt=C(null,(e,s,n)=>{const r=e(D);r.some(i=>i.code===n.code)||s(D,[...r,n])}),rt=C(null,(e,s,n)=>{const r=e(D);s(D,r.filter(i=>i.code!==n))}),K=C([]),M=C(null,(e,s,{message:n,type:r})=>{const i=Date.now().toString();s(K,a=>[...a,{id:i,message:n,type:r}])});C(null,(e,s,n)=>{s(K,r=>r.filter(i=>i.id!==n))});const Se=C(!1),_e=C(""),ce=C(!1),ae=C(null),de=C({name:"",price:0,stock:0,description:"",discounts:[]}),le=C(!1),ot=C({name:"",code:"",discountType:"amount",discountValue:0}),it=()=>{const[e]=j(_),[s,n]=j(Se),[,r]=j(_e),[i,a]=A.useState(""),c=A.useMemo(()=>e.reduce((u,o)=>u+o.quantity,0),[e]);return A.useEffect(()=>{const m=setTimeout(()=>{r(i)},500);return()=>clearTimeout(m)},[i,r]),t.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40 border-b",children:t.jsx("div",{className:"max-w-7xl mx-auto px-4",children:t.jsxs("div",{className:"flex justify-between items-center h-16",children:[t.jsxs("div",{className:"flex items-center flex-1",children:[t.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"SHOP"}),!s&&t.jsx("div",{className:"ml-8 flex-1 max-w-md",children:t.jsx("input",{type:"text",value:i,onChange:m=>a(m.target.value),placeholder:"상품 검색...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})})]}),t.jsxs("nav",{className:"flex items-center space-x-4",children:[t.jsx("button",{onClick:()=>n(!s),className:`px-3 py-1.5 text-sm rounded transition-colors ${s?"bg-gray-800 text-white":"text-gray-600 hover:text-gray-900"}`,children:s?"쇼핑몰로 돌아가기":"관리자 페이지로"}),!s&&t.jsxs("div",{className:"relative",children:[t.jsx("svg",{className:"w-6 h-6 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),e.length>0&&t.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:c})]})]})]})})})};function ct(){const[e,s]=j(K);return A.useEffect(()=>{const n=e.map(r=>setTimeout(()=>{s(i=>i.filter(a=>a.id!==r.id))},3e3));return()=>n.forEach(clearTimeout)},[e,s]),t.jsx("div",{className:"fixed top-20 right-4 z-50 space-y-2 max-w-sm",children:e.map(n=>t.jsxs("div",{className:`p-4 rounded-md shadow-md text-white flex justify-between items-center ${n.type==="error"?"bg-red-600":n.type==="warning"?"bg-yellow-600":"bg-green-600"}`,children:[t.jsx("span",{className:"mr-2",children:n.message}),t.jsx("button",{onClick:()=>s(r=>r.filter(i=>i.id!==n.id)),className:"text-white hover:text-gray-200",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},n.id))})}const at=e=>(e.match(/\d+/g)||[]).join(""),Pe=e=>{const s=at(e);return s===""?0:parseInt(s,10)},dt=e=>/^\d+$/.test(e);function lt(){const[e,s]=j(ot),[n]=j(D),r=w(M),i=w(le),a=w(nt),c=()=>i(!1),m=u=>{u.preventDefault(),n.some(o=>o.code===e.code)?r({message:"이미 존재하는 쿠폰 코드입니다.",type:"error"}):(a(e),r({message:"쿠폰이 추가되었습니다.",type:"success"})),s({name:"",code:"",discountType:"amount",discountValue:0}),i(!1)};return t.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:t.jsxs("form",{onSubmit:m,className:"space-y-4",children:[t.jsx("h3",{className:"text-md font-medium text-gray-900",children:"새 쿠폰 생성"}),t.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"쿠폰명"}),t.jsx("input",{type:"text",value:e.name,onChange:u=>s({...e,name:u.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",placeholder:"신규 가입 쿠폰",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"쿠폰 코드"}),t.jsx("input",{type:"text",value:e.code,onChange:u=>s({...e,code:u.target.value.toUpperCase()}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm font-mono",placeholder:"WELCOME2024",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"할인 타입"}),t.jsxs("select",{value:e.discountType,onChange:u=>s({...e,discountType:u.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",children:[t.jsx("option",{value:"amount",children:"정액 할인"}),t.jsx("option",{value:"percentage",children:"정률 할인"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e.discountType==="amount"?"할인 금액":"할인율(%)"}),t.jsx("input",{type:"text",value:e.discountValue===0?"":e.discountValue,onChange:u=>s({...e,discountValue:Pe(u.target.value)}),onBlur:u=>{const o=parseInt(u.target.value)||0;e.discountType==="percentage"?o>100?(r({message:"할인율은 100%를 초과할 수 없습니다",type:"error"}),s({...e,discountValue:100})):o<0&&s({...e,discountValue:0}):o>1e5?(r({message:"할인 금액은 100,000원을 초과할 수 없습니다",type:"error"}),s({...e,discountValue:1e5})):o<0&&s({...e,discountValue:0})},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",placeholder:e.discountType==="amount"?"5000":"10",required:!0})]})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"취소"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700",children:"쿠폰 생성"})]})]})})}const E=e=>`${e.toLocaleString()}원`,ut=e=>`${Math.round(e*100)}%`;function mt(){const[e]=j(D),s=w(rt),n=w(M),r=w(le),i=c=>{s(c),n({message:"쿠폰이 삭제되었습니다.",type:"success"})},a=()=>r(!0);return t.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[e.map(c=>t.jsx("div",{className:"relative bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-4 border border-indigo-200",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:c.name}),t.jsx("p",{className:"text-sm text-gray-600 mt-1 font-mono",children:c.code}),t.jsx("div",{className:"mt-2",children:t.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-white text-indigo-700",children:c.discountType==="amount"?`${E(c.discountValue)} 할인`:`${c.discountValue}% 할인`})})]}),t.jsx("button",{onClick:()=>i(c.code),className:"text-gray-400 hover:text-red-600 transition-colors",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})},c.code)),t.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 flex items-center justify-center hover:border-gray-400 transition-colors",children:t.jsxs("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 flex flex-col items-center",children:[t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),t.jsx("p",{className:"mt-2 text-sm font-medium",children:"새 쿠폰 추가"})]})})]})}function xt(){const[e]=j(le);return t.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsx("h2",{className:"text-lg font-semibold",children:"쿠폰 관리"})}),t.jsxs("div",{className:"p-6",children:[t.jsx(mt,{}),e&&t.jsx(lt,{})]})]})}function ht(){const[e,s]=j(de),[n]=j(ae),r=w(M),i=w(ce),a=w(tt),c=w(et),m=()=>{i(!1)},u=o=>{o.preventDefault(),n&&n!=="new"?(c({productId:n,updates:e}),r({message:"상품이 수정되었습니다.",type:"success"})):(a({...e,discounts:e.discounts}),r({message:"상품이 추가되었습니다.",type:"success"})),i(!1)};return t.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:t.jsxs("form",{onSubmit:u,className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900",children:n==="new"?"새 상품 추가":"상품 수정"}),t.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"상품명"}),t.jsx("input",{type:"text",value:e.name,onChange:o=>s({...e,name:o.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"설명"}),t.jsx("input",{type:"text",value:e.description,onChange:o=>s({...e,description:o.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"가격"}),t.jsx("input",{type:"text",value:e.price===0?"":e.price,onChange:o=>{const{value:l}=o.target;(l===""||dt(l))&&s({...e,price:l===""?0:parseInt(l)})},onBlur:o=>{const{value:l}=o.target;l===""?s({...e,price:0}):parseInt(l)<0&&(r({message:"가격은 0보다 커야 합니다",type:"error"}),s({...e,price:0}))},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",placeholder:"숫자만 입력",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"재고"}),t.jsx("input",{type:"text",value:e.stock===0?"":e.stock,onChange:o=>s({...e,stock:Pe(o.target.value)}),onBlur:o=>{const{value:l}=o.target;l===""?s({...e,stock:0}):parseInt(l)<0?(r({message:"재고는 0보다 커야 합니다",type:"error"}),s({...e,stock:0})):parseInt(l)>9999&&(r({message:"재고는 9999개를 초과할 수 없습니다",type:"error"}),s({...e,stock:9999}))},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",placeholder:"숫자만 입력",required:!0})]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"할인 정책"}),t.jsxs("div",{className:"space-y-2",children:[e.discounts.map((o,l)=>t.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 p-2 rounded",children:[t.jsx("input",{type:"number",value:o.quantity,onChange:g=>{const h=[...e.discounts];h[l].quantity=parseInt(g.target.value)||0,s({...e,discounts:h})},className:"w-20 px-2 py-1 border rounded",min:"1",placeholder:"수량"}),t.jsx("span",{className:"text-sm",children:"개 이상 구매 시"}),t.jsx("input",{type:"number",value:o.rate*100,onChange:g=>{const h=[...e.discounts];h[l].rate=(parseInt(g.target.value)||0)/100,s({...e,discounts:h})},className:"w-16 px-2 py-1 border rounded",min:"0",max:"100",placeholder:"%"}),t.jsx("span",{className:"text-sm",children:"% 할인"}),t.jsx("button",{type:"button",onClick:()=>{const g=e.discounts.filter((h,v)=>v!==l);s({...e,discounts:g})},className:"text-red-600 hover:text-red-800",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},l)),t.jsx("button",{type:"button",onClick:()=>{s({...e,discounts:[...e.discounts,{quantity:10,rate:.1}]})},className:"text-sm text-indigo-600 hover:text-indigo-800",children:"+ 할인 추가"})]})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{type:"button",onClick:m,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"취소"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700",children:n==="new"?"추가":"수정"})]})]})})}function ft(){const[e]=j(L),s=w(st),n=w(M),r=w(ce),i=w(ae),a=w(de),c=(o,l)=>{if(l){const g=e.find(h=>h.id===l);if(g&&g.stock<=0)return"SOLD OUT"}return E(o)},m=o=>{i(o.id),a({name:o.name,price:o.price,stock:o.stock,description:o.description||"",discounts:o.discounts||[]}),r(!0)},u=o=>{s(o),n({message:"상품이 삭제되었습니다.",type:"success"})};return t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상품명"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"가격"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"재고"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"설명"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"작업"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(o=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:o.name}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:c(o.price,o.id)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${o.stock>10?"bg-green-100 text-green-800":o.stock>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[o.stock,"개"]})}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:o.description||"-"}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[t.jsx("button",{onClick:()=>m(o),className:"text-indigo-600 hover:text-indigo-900 mr-3",children:"수정"}),t.jsx("button",{onClick:()=>u(o.id),className:"text-red-600 hover:text-red-900",children:"삭제"})]})]},o.id))})]})})}function pt(){const[e,s]=j(ce),n=w(ae),r=w(de);return t.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"상품 목록"}),t.jsx("button",{onClick:()=>{n("new"),r({name:"",price:0,stock:0,description:"",discounts:[]}),s(!0)},className:"px-4 py-2 bg-gray-900 text-white text-sm rounded-md hover:bg-gray-800",children:"새 상품 추가"})]})}),t.jsx(ft,{}),e&&t.jsx(ht,{})]})}function gt(){j(D),j(L);const[e,s]=A.useState("products");return t.jsxs("div",{className:"max-w-6xl mx-auto",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"관리자 대시보드"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"상품과 쿠폰을 관리할 수 있습니다"})]}),t.jsx("div",{className:"border-b border-gray-200 mb-6",children:t.jsxs("nav",{className:"-mb-px flex space-x-8",children:[t.jsx("button",{onClick:()=>s("products"),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${e==="products"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"상품 관리"}),t.jsx("button",{onClick:()=>s("coupons"),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${e==="coupons"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"쿠폰 관리"})]})}),e==="products"?t.jsx(pt,{}):t.jsx(xt,{})]})}const yt=(e,s)=>{const{discounts:n}=e.product,{quantity:r}=e,i=n.reduce((c,m)=>r>=m.quantity&&m.rate>c?m.rate:c,0);return s.some(c=>c.quantity>=10)?Math.min(i+.05,.5):i},Ae=(e,s)=>{const{price:n}=e.product,{quantity:r}=e,i=yt(e,s);return Math.round(n*r*(1-i))},Te=(e,s)=>{let n=0,r=0;return e.forEach(i=>{const a=i.product.price*i.quantity;n+=a,r+=Ae(i,e)}),s&&(s.discountType==="amount"?r=Math.max(0,r-s.discountValue):r=Math.round(r*(1-s.discountValue/100))),{totalBeforeDiscount:Math.round(n),totalAfterDiscount:Math.round(r)}},bt=(e,s)=>!(s<1e4&&e.discountType==="percentage");function vt(e){const{item:s}=e,[n]=j(_),[r]=j(L),i=w(Xe),a=w(He),c=w(M),m=Ae(s,n),u=s.product.price*s.quantity,o=m<u,l=o?Math.round((1-m/u)*100):0,g=(h,v)=>{if(v<=0){a(h);return}const N=r.find(q=>q.id===h);if(!N)return;const T=N.stock;if(v>T){c({message:`재고는 ${T}개까지만 있습니다.`,type:"error"});return}i({productId:h,quantity:v})};return t.jsxs("div",{className:"border-b pb-3 last:border-b-0",children:[t.jsxs("div",{className:"flex justify-between items-start mb-2",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-900 flex-1",children:s.product.name}),t.jsx("button",{onClick:()=>a(s.product.id),className:"text-gray-400 hover:text-red-500 ml-2",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("button",{onClick:()=>g(s.product.id,s.quantity-1),className:"w-6 h-6 rounded border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:t.jsx("span",{className:"text-xs",children:"−"})}),t.jsx("span",{className:"mx-3 text-sm font-medium w-8 text-center",children:s.quantity}),t.jsx("button",{onClick:()=>g(s.product.id,s.quantity+1),className:"w-6 h-6 rounded border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:t.jsx("span",{className:"text-xs",children:"+"})})]}),t.jsxs("div",{className:"text-right",children:[o&&t.jsxs("span",{className:"text-xs text-red-500 font-medium block",children:["-",ut(l/100)]}),t.jsx("p",{className:"text-sm font-medium text-gray-900",children:E(Math.round(m))})]})]})]})}function jt(){const[e]=j(_);return t.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),"장바구니"]}),e.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),t.jsx("p",{className:"text-gray-500 text-sm",children:"장바구니가 비어있습니다"})]}):t.jsx("div",{className:"space-y-3",children:e.map(s=>t.jsx(vt,{item:s},s.product.id))})]})}function wt(){const[e]=j(D),[s,n]=j(ie),[r]=j(_),i=w(M),a=c=>{const m=e.find(o=>o.code===c.target.value)||null;if(!m){n(null);return}const u=Te(r).totalAfterDiscount;if(!bt(m,u)){i({message:"percentage 쿠폰은 10,000원 이상 구매 시 사용 가능합니다.",type:"error"});return}n(m),i({message:"쿠폰이 적용되었습니다.",type:"success"})};return t.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"쿠폰 할인"}),t.jsx("button",{className:"text-xs text-blue-600 hover:underline",children:"쿠폰 등록"})]}),e.length>0&&t.jsxs("select",{className:"w-full text-sm border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500",value:s?.code||"",onChange:a,children:[t.jsx("option",{value:"",children:"쿠폰 선택"}),e.map(c=>t.jsxs("option",{value:c.code,children:[c.name," (",c.discountType==="amount"?`${E(c.discountValue)}`:`${c.discountValue}%`,")"]},c.code))]})]})}function Nt(){const[e]=j(_),[s,n]=j(ie),r=w(Ye),i=w(M),a=Te(e,s||void 0),c=a.totalBeforeDiscount-a.totalAfterDiscount,m=c>0,u=()=>{const o=`ORD-${Date.now()}`;i({message:`주문이 완료되었습니다. 주문번호: ${o}`,type:"success"}),r(),n(null)};return t.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"결제 정보"}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"상품 금액"}),t.jsx("span",{className:"font-medium",children:E(a.totalBeforeDiscount)})]}),m&&t.jsxs("div",{className:"flex justify-between text-red-500",children:[t.jsx("span",{children:"할인 금액"}),t.jsxs("span",{children:["-",E(c)]})]}),t.jsxs("div",{className:"flex justify-between py-2 border-t border-gray-200",children:[t.jsx("span",{className:"font-semibold",children:"결제 예정 금액"}),t.jsx("span",{className:"font-bold text-lg text-gray-900",children:E(a.totalAfterDiscount)})]})]}),t.jsxs("button",{onClick:u,className:"w-full mt-4 py-3 bg-yellow-400 text-gray-900 rounded-md font-medium hover:bg-yellow-500 transition-colors",children:[E(a.totalAfterDiscount)," 결제하기"]}),t.jsx("div",{className:"mt-3 text-xs text-gray-500 text-center",children:t.jsx("p",{children:"* 실제 결제는 이루어지지 않습니다"})})]})}function kt(){const[e]=j(_);return t.jsxs("div",{className:"sticky top-24 space-y-4",children:[t.jsx(jt,{}),e.length>0&&t.jsxs(t.Fragment,{children:[t.jsx(wt,{}),t.jsx(Nt,{})]})]})}function Ct(e){const{product:s,price:n,remainingStock:r,handleAddToCart:i}=e;return t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"aspect-square bg-gray-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-24 h-24 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),s.isRecommended&&t.jsx("span",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded",children:"BEST"}),s.discounts.length>0&&t.jsxs("span",{className:"absolute top-2 left-2 bg-orange-500 text-white text-xs px-2 py-1 rounded",children:["~",Math.max(...s.discounts.map(a=>a.rate))*100,"%"]})]}),t.jsxs("div",{className:"p-4",children:[t.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:s.name}),s.description&&t.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-2",children:s.description}),t.jsxs("div",{className:"mb-3",children:[t.jsx("p",{className:"text-lg font-bold text-gray-900",children:n}),s.discounts.length>0&&t.jsxs("p",{className:"text-xs text-gray-500",children:[s.discounts[0].quantity,"개 이상 구매시 할인 ",s.discounts[0].rate*100,"%"]})]}),t.jsxs("div",{className:"mb-3",children:[r<=5&&r>0&&t.jsxs("p",{className:"text-xs text-red-600 font-medium",children:["품절임박! ",r,"개 남음"]}),r>5&&t.jsxs("p",{className:"text-xs text-gray-500",children:["재고 ",r,"개"]})]}),t.jsx("button",{onClick:()=>i(s),disabled:r<=0,className:`w-full py-2 px-4 rounded-md font-medium transition-colors ${r<=0?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800"}`,children:r<=0?"품절":"장바구니 담기"})]})]})}function St(e){const{debouncedSearchTerm:s}=e,[n]=j(_),[r]=j(L),i=w(Ze),a=w(M),c=(o,l)=>{if(l){const g=r.find(h=>h.id===l);if(g&&ne(g,n)<=0)return"SOLD OUT"}return E(o)},m=o=>{try{i(o),a({message:"장바구니에 담았습니다",type:"success"})}catch(l){a({message:l instanceof Error?l.message:"알 수 없는 오류가 발생했습니다.",type:"error"})}},u=s?r.filter(o=>o.name.toLowerCase().includes(s.toLowerCase())||o.description&&o.description.toLowerCase().includes(s.toLowerCase())):r;return t.jsxs("section",{children:[t.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[t.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"전체 상품"}),t.jsxs("div",{className:"text-sm text-gray-600",children:["총 ",r.length,"개 상품"]})]}),u.length===0?t.jsx("div",{className:"text-center py-12",children:t.jsxs("p",{className:"text-gray-500",children:['"',s,'"에 대한 검색 결과가 없습니다.']})}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:u.map(o=>{const l=ne(o,n),g=c(o.price,o.id);return t.jsx(Ct,{product:o,price:g,remainingStock:l,handleAddToCart:m},o.id)})})]})}function _t(){const[e]=j(_e);return t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[t.jsx("div",{className:"lg:col-span-3",children:t.jsx(St,{debouncedSearchTerm:e})}),t.jsx("div",{className:"lg:col-span-1",children:t.jsx(kt,{})})]})}const Pt=()=>{j(_);const[e]=j(Se),[s]=j(K);return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.length>0&&t.jsx(ct,{}),t.jsx(it,{}),t.jsx("main",{className:"max-w-7xl mx-auto px-4 py-8",children:e?t.jsx(gt,{}):t.jsx(_t,{})})]})},At=()=>t.jsx(We,{children:t.jsx(Pt,{})});Ee.createRoot(document.getElementById("root")).render(t.jsx(re.StrictMode,{children:t.jsx(At,{})}));
