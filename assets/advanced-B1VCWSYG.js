import{r as _,a as ne,j as t,R as Te}from"./client-DvaAtPIX.js";const q={},de=(e,s)=>e.unstable_is?e.unstable_is(s):s===e,ue=e=>"init"in e,X=e=>!!e.write,me=e=>"v"in e||"e"in e,B=e=>{if("e"in e)throw e.e;if((q?"production":void 0)!=="production"&&!("v"in e))throw new Error("[Bug] atom state is not initialized");return e.v},z=new WeakMap,xe=e=>{var s;return U(e)&&!!((s=z.get(e))!=null&&s[0])},Le=e=>{const s=z.get(e);s?.[0]&&(s[0]=!1,s[1].forEach(n=>n()))},ye=(e,s)=>{let n=z.get(e);if(!n){n=[!0,new Set],z.set(e,n);const r=()=>{n[0]=!1};e.then(r,r)}n[1].add(s)},U=e=>typeof e?.then=="function",be=(e,s,n)=>{n.p.has(e)||(n.p.add(e),s.then(()=>{n.p.delete(e)},()=>{n.p.delete(e)}))},Y=(e,s,n)=>{const r=n(e),i="v"in r,a=r.v;if(U(s))for(const l of r.d.keys())be(e,s,n(l));r.v=s,delete r.e,(!i||!Object.is(a,r.v))&&(++r.n,U(a)&&Le(a))},he=(e,s,n)=>{var r;const i=new Set;for(const a of((r=n.get(e))==null?void 0:r.t)||[])n.has(a)&&i.add(a);for(const a of s.p)i.add(a);return i},Ee=Symbol(),De=(e=new WeakMap,s=new WeakMap,n=new WeakMap,r=new Set,i=new Set,a=new Set,l={},h=(m,...b)=>m.read(...b),u=(m,...b)=>m.write(...b),o=(m,b)=>{var w;return(w=m.unstable_onInit)==null?void 0:w.call(m,b)},c=(m,b)=>{var w;return(w=m.onMount)==null?void 0:w.call(m,b)},...x)=>{const m=x[0]||(d=>{if((q?"production":void 0)!=="production"&&!d)throw new Error("Atom is undefined or null");let v=e.get(d);return v||(v={d:new Map,p:new Set,n:0},e.set(d,v),o?.(d,K)),v}),b=x[1]||(()=>{const d=[],v=y=>{try{y()}catch(p){d.push(p)}};do{l.f&&v(l.f);const y=new Set,p=y.add.bind(y);r.forEach(f=>{var g;return(g=s.get(f))==null?void 0:g.l.forEach(p)}),r.clear(),a.forEach(p),a.clear(),i.forEach(p),i.clear(),y.forEach(v),r.size&&w()}while(r.size||a.size||i.size);if(d.length)throw new AggregateError(d)}),w=x[2]||(()=>{const d=[],v=new WeakSet,y=new WeakSet,p=Array.from(r);for(;p.length;){const f=p[p.length-1],g=m(f);if(y.has(f)){p.pop();continue}if(v.has(f)){if(n.get(f)===g.n)d.push([f,g]);else if((q?"production":void 0)!=="production"&&n.has(f))throw new Error("[Bug] invalidated atom exists");y.add(f),p.pop();continue}v.add(f);for(const S of he(f,g,s))v.has(S)||p.push(S)}for(let f=d.length-1;f>=0;--f){const[g,S]=d[f];let A=!1;for(const D of S.d.keys())if(D!==g&&r.has(D)){A=!0;break}A&&(L(g),$(g)),n.delete(g)}}),L=x[3]||(d=>{var v;const y=m(d);if(me(y)&&(s.has(d)&&n.get(d)!==y.n||Array.from(y.d).every(([k,W])=>L(k).n===W)))return y;y.d.clear();let p=!0;const f=()=>{s.has(d)&&($(d),w(),b())},g=k=>{var W;if(de(d,k)){const le=m(k);if(!me(le))if(ue(k))Y(k,k.init,m);else throw new Error("no atom init");return B(le)}const H=L(k);try{return B(H)}finally{y.d.set(k,H.n),xe(y.v)&&be(d,y.v,H),(W=s.get(k))==null||W.t.add(d),p||f()}};let S,A;const D={get signal(){return S||(S=new AbortController),S.signal},get setSelf(){return(q?"production":void 0)!=="production"&&!X(d)&&console.warn("setSelf function cannot be used with read-only atom"),!A&&X(d)&&(A=(...k)=>{if((q?"production":void 0)!=="production"&&p&&console.warn("setSelf function cannot be called in sync"),!p)try{return I(d,...k)}finally{w(),b()}}),A}},F=y.n;try{const k=h(d,g,D);return Y(d,k,m),U(k)&&(ye(k,()=>S?.abort()),k.then(f,f)),y}catch(k){return delete y.v,y.e=k,++y.n,y}finally{p=!1,F!==y.n&&n.get(d)===F&&(n.set(d,y.n),r.add(d),(v=l.c)==null||v.call(l,d))}}),G=x[4]||(d=>{const v=[d];for(;v.length;){const y=v.pop(),p=m(y);for(const f of he(y,p,s)){const g=m(f);n.set(f,g.n),v.push(f)}}}),I=x[5]||((d,...v)=>{let y=!0;const p=g=>B(L(g)),f=(g,...S)=>{var A;const D=m(g);try{if(de(d,g)){if(!ue(g))throw new Error("atom not writable");const F=D.n,k=S[0];Y(g,k,m),$(g),F!==D.n&&(r.add(g),(A=l.c)==null||A.call(l,g),G(g));return}else return I(g,...S)}finally{y||(w(),b())}};try{return u(d,p,f,...v)}finally{y=!1}}),$=x[6]||(d=>{var v;const y=m(d),p=s.get(d);if(p&&!xe(y.v)){for(const[f,g]of y.d)if(!p.d.has(f)){const S=m(f);R(f).t.add(d),p.d.add(f),g!==S.n&&(r.add(f),(v=l.c)==null||v.call(l,f),G(f))}for(const f of p.d||[])if(!y.d.has(f)){p.d.delete(f);const g=O(f);g?.t.delete(d)}}}),R=x[7]||(d=>{var v;const y=m(d);let p=s.get(d);if(!p){L(d);for(const f of y.d.keys())R(f).t.add(d);if(p={l:new Set,d:new Set(y.d.keys()),t:new Set},s.set(d,p),(v=l.m)==null||v.call(l,d),X(d)){const f=()=>{let g=!0;const S=(...A)=>{try{return I(d,...A)}finally{g||(w(),b())}};try{const A=c(d,S);A&&(p.u=()=>{g=!0;try{A()}finally{g=!1}})}finally{g=!1}};i.add(f)}}return p}),O=x[8]||(d=>{var v;const y=m(d);let p=s.get(d);if(p&&!p.l.size&&!Array.from(p.t).some(f=>{var g;return(g=s.get(f))==null?void 0:g.d.has(d)})){p.u&&a.add(p.u),p=void 0,s.delete(d),(v=l.u)==null||v.call(l,d);for(const f of y.d.keys()){const g=O(f);g?.t.delete(d)}return}return p}),Pe=[e,s,n,r,i,a,l,h,u,o,c,m,b,w,L,G,I,$,R,O],K={get:d=>B(L(d)),set:(d,...v)=>{try{return I(d,...v)}finally{w(),b()}},sub:(d,v)=>{const p=R(d).l;return p.add(v),b(),()=>{p.delete(v),O(d),b()}}};return Object.defineProperty(K,Ee,{value:Pe}),K},Ie=De,fe=ye,ve={};let Me=0;function C(e,s){const n=`atom${++Me}`,r={toString(){return(ve?"production":void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof e=="function"?r.read=e:(r.init=e,r.read=qe,r.write=Ve),s&&(r.write=s),r}function qe(e){return e(this)}function Ve(e,s,n){return s(this,typeof n=="function"?n(e(this)):n)}function je(){return Ie()}let M;function $e(){return M||(M=je(),(ve?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=M),globalThis.__JOTAI_DEFAULT_STORE__!==M&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),M}const Re={},we=_.createContext(void 0);function Ne(e){return _.useContext(we)||$e()}function Oe({children:e,store:s}){const n=_.useRef(void 0);return!s&&!n.current&&(n.current=je()),_.createElement(we.Provider,{value:s||n.current},e)}const ee=e=>typeof e?.then=="function",te=e=>{e.status||(e.status="pending",e.then(s=>{e.status="fulfilled",e.value=s},s=>{e.status="rejected",e.reason=s}))},Fe=ne.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(te(e),e)}),Z=new WeakMap,pe=(e,s)=>{let n=Z.get(e);return n||(n=new Promise((r,i)=>{let a=e;const l=o=>c=>{a===o&&r(c)},h=o=>c=>{a===o&&i(c)},u=()=>{try{const o=s();ee(o)?(Z.set(o,n),a=o,o.then(l(o),h(o)),fe(o,u)):r(o)}catch(o){i(o)}};e.then(l(e),h(e)),fe(e,u)}),Z.set(e,n)),n};function We(e,s){const{delay:n,unstable_promiseStatus:r=!ne.use}={},i=Ne(),[[a,l,h],u]=_.useReducer(c=>{const x=i.get(e);return Object.is(c[0],x)&&c[1]===i&&c[2]===e?c:[x,i,e]},void 0,()=>[i.get(e),i,e]);let o=a;if((l!==i||h!==e)&&(u(),o=i.get(e)),_.useEffect(()=>{const c=i.sub(e,()=>{if(r)try{const x=i.get(e);ee(x)&&te(pe(x,()=>i.get(e)))}catch{}if(typeof n=="number"){setTimeout(u,n);return}u()});return u(),c},[i,e,n,r]),_.useDebugValue(o),ee(o)){const c=pe(o,()=>i.get(e));return r&&te(c),Fe(c)}return o}function N(e,s){const n=Ne();return _.useCallback((...i)=>{if((Re?"production":void 0)!=="production"&&!("write"in e))throw new Error("not writable atom");return n.set(e,...i)},[n,e])}function j(e,s){return[We(e),N(e)]}const re={},Be=Symbol((re?"production":void 0)!=="production"?"RESET":""),ke=e=>typeof e?.then=="function";function ze(e=()=>{try{return window.localStorage}catch(n){(re?"production":void 0)!=="production"&&typeof window<"u"&&console.warn(n);return}},s){var n;let r,i;const a={getItem:(u,o)=>{var c,x;const m=w=>{if(w=w||"",r!==w){try{i=JSON.parse(w,s?.reviver)}catch{return o}r=w}return i},b=(x=(c=e())==null?void 0:c.getItem(u))!=null?x:null;return ke(b)?b.then(m):m(b)},setItem:(u,o)=>{var c;return(c=e())==null?void 0:c.setItem(u,JSON.stringify(o,void 0))},removeItem:u=>{var o;return(o=e())==null?void 0:o.removeItem(u)}},l=u=>(o,c,x)=>u(o,m=>{let b;try{b=JSON.parse(m||"")}catch{b=x}c(b)});let h;try{h=(n=e())==null?void 0:n.subscribe}catch{}return!h&&typeof window<"u"&&typeof window.addEventListener=="function"&&window.Storage&&(h=(u,o)=>{if(!(e()instanceof window.Storage))return()=>{};const c=x=>{x.storageArea===e()&&x.key===u&&o(x.newValue)};return window.addEventListener("storage",c),()=>{window.removeEventListener("storage",c)}}),h&&(a.subscribe=l(h)),a}const Ue=ze();function J(e,s,n=Ue,r){const i=C(s);return(re?"production":void 0)!=="production"&&(i.debugPrivate=!0),i.onMount=l=>{l(n.getItem(e,s));let h;return n.subscribe&&(h=n.subscribe(e,l,s)),h},C(l=>l(i),(l,h,u)=>{const o=typeof u=="function"?u(l(i)):u;return o===Be?(h(i,s),n.removeItem(e)):ke(o)?o.then(c=>(h(i,c),n.setItem(e,c))):(h(i,o),n.setItem(e,o))})}const Je=[{id:"p1",name:"상품1",price:1e4,stock:20,discounts:[{quantity:10,rate:.1},{quantity:20,rate:.2}],description:"최고급 품질의 프리미엄 상품입니다."},{id:"p2",name:"상품2",price:2e4,stock:20,discounts:[{quantity:10,rate:.15}],description:"다양한 기능을 갖춘 실용적인 상품입니다.",isRecommended:!0},{id:"p3",name:"상품3",price:3e4,stock:20,discounts:[{quantity:10,rate:.2},{quantity:30,rate:.25}],description:"대용량과 고성능을 자랑하는 상품입니다."}],Qe=[{name:"5000원 할인",code:"AMOUNT5000",discountType:"amount",discountValue:5e3},{name:"10% 할인",code:"PERCENT10",discountType:"percentage",discountValue:10}],se=(e,s)=>{const n=s.find(r=>r.product.id===e.id);return e.stock-(n?.quantity||0)},Ce=C(!1),Se=C(""),V=C([]),T=J("products",Je),E=J("coupons",Qe),P=J("cart",[]),_e=J("selectedCoupon",null),Ge=C(null,(e,s,n)=>{const r=e(P);if(se(n,r)<=0)throw new Error(`상품 "${n.name}"의 재고가 부족합니다.`);const a=r.find(l=>l.product.id===n.id);if(a){const l=a.quantity+1;if(l>n.stock)throw new Error(`상품 "${n.name}"의 재고는 ${n.stock}개까지만 가능합니다.`);s(P,r.map(h=>h.product.id===n.id?{...h,quantity:l}:h))}else s(P,[...r,{product:n,quantity:1}])}),Ke=C(null,(e,s,n)=>{const r=e(P);s(P,r.filter(i=>i.product.id!==n))}),He=C(null,(e,s,{productId:n,quantity:r})=>{const i=e(P);s(P,i.map(a=>a.product.id===n?{...a,quantity:r}:a))}),Xe=C(null,(e,s)=>{s(P,[]),s(_e,null)}),Q=C(null,(e,s,{message:n,type:r})=>{const i=Date.now().toString();s(V,a=>[...a,{id:i,message:n,type:r}])});C(null,(e,s,n)=>{s(V,r=>r.filter(i=>i.id!==n))});const Ye=C(null,(e,s,{productId:n,updates:r})=>{const i=e(T);s(T,i.map(a=>a.id===n?{...a,...r}:a))}),Ze=C(null,(e,s,n)=>{const r=e(T),i={...n,id:`p${Date.now()}`};s(T,[...r,i])}),et=C(null,(e,s,n)=>{const r=e(T);s(T,r.filter(i=>i.id!==n))}),tt=C(null,(e,s,n)=>{const r=e(E);r.some(i=>i.code===n.code)||s(E,[...r,n])}),st=C(null,(e,s,n)=>{const r=e(E);s(E,r.filter(i=>i.code!==n))}),oe=C(!1),ie=C(null),ce=C({name:"",price:0,stock:0,description:"",discounts:[]}),ae=C(!1),nt=C({name:"",code:"",discountType:"amount",discountValue:0}),rt=()=>{const[e]=j(P),[s,n]=j(Ce),[,r]=j(Se),[i,a]=_.useState(""),l=_.useMemo(()=>e.reduce((u,o)=>u+o.quantity,0),[e]);return _.useEffect(()=>{const h=setTimeout(()=>{r(i)},500);return()=>clearTimeout(h)},[i,r]),t.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40 border-b",children:t.jsx("div",{className:"max-w-7xl mx-auto px-4",children:t.jsxs("div",{className:"flex justify-between items-center h-16",children:[t.jsxs("div",{className:"flex items-center flex-1",children:[t.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"SHOP"}),!s&&t.jsx("div",{className:"ml-8 flex-1 max-w-md",children:t.jsx("input",{type:"text",value:i,onChange:h=>a(h.target.value),placeholder:"상품 검색...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})})]}),t.jsxs("nav",{className:"flex items-center space-x-4",children:[t.jsx("button",{onClick:()=>n(!s),className:`px-3 py-1.5 text-sm rounded transition-colors ${s?"bg-gray-800 text-white":"text-gray-600 hover:text-gray-900"}`,children:s?"쇼핑몰로 돌아가기":"관리자 페이지로"}),!s&&t.jsxs("div",{className:"relative",children:[t.jsx("svg",{className:"w-6 h-6 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),e.length>0&&t.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:l})]})]})]})})})};function ot(){const[e,s]=j(V);return _.useEffect(()=>{const n=e.map(r=>setTimeout(()=>{s(i=>i.filter(a=>a.id!==r.id))},3e3));return()=>n.forEach(clearTimeout)},[e,s]),t.jsx("div",{className:"fixed top-20 right-4 z-50 space-y-2 max-w-sm",children:e.map(n=>t.jsxs("div",{className:`p-4 rounded-md shadow-md text-white flex justify-between items-center ${n.type==="error"?"bg-red-600":n.type==="warning"?"bg-yellow-600":"bg-green-600"}`,children:[t.jsx("span",{className:"mr-2",children:n.message}),t.jsx("button",{onClick:()=>s(r=>r.filter(i=>i.id!==n.id)),className:"text-white hover:text-gray-200",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},n.id))})}function it(){const[e,s]=j(nt),[n]=j(E),r=N(Q),i=N(ae),a=N(tt),l=()=>i(!1),h=u=>{u.preventDefault(),n.some(o=>o.code===e.code)?r({message:"이미 존재하는 쿠폰 코드입니다.",type:"error"}):(a(e),r({message:"쿠폰이 추가되었습니다.",type:"success"})),s({name:"",code:"",discountType:"amount",discountValue:0}),i(!1)};return t.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:t.jsxs("form",{onSubmit:h,className:"space-y-4",children:[t.jsx("h3",{className:"text-md font-medium text-gray-900",children:"새 쿠폰 생성"}),t.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"쿠폰명"}),t.jsx("input",{type:"text",value:e.name,onChange:u=>s({...e,name:u.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",placeholder:"신규 가입 쿠폰",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"쿠폰 코드"}),t.jsx("input",{type:"text",value:e.code,onChange:u=>s({...e,code:u.target.value.toUpperCase()}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm font-mono",placeholder:"WELCOME2024",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"할인 타입"}),t.jsxs("select",{value:e.discountType,onChange:u=>s({...e,discountType:u.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",children:[t.jsx("option",{value:"amount",children:"정액 할인"}),t.jsx("option",{value:"percentage",children:"정률 할인"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e.discountType==="amount"?"할인 금액":"할인율(%)"}),t.jsx("input",{type:"text",value:e.discountValue===0?"":e.discountValue,onChange:u=>{const{value:o}=u.target;(o===""||/^\d+$/.test(o))&&s({...e,discountValue:o===""?0:parseInt(o)})},onBlur:u=>{const o=parseInt(u.target.value)||0;e.discountType==="percentage"?o>100?(r({message:"할인율은 100%를 초과할 수 없습니다",type:"error"}),s({...e,discountValue:100})):o<0&&s({...e,discountValue:0}):o>1e5?(r({message:"할인 금액은 100,000원을 초과할 수 없습니다",type:"error"}),s({...e,discountValue:1e5})):o<0&&s({...e,discountValue:0})},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",placeholder:e.discountType==="amount"?"5000":"10",required:!0})]})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{type:"button",onClick:l,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"취소"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700",children:"쿠폰 생성"})]})]})})}function ct(){const[e]=j(E),s=N(st),n=N(Q),r=N(ae),i=l=>{s(l),n({message:"쿠폰이 삭제되었습니다.",type:"success"})},a=()=>r(!0);return t.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[e.map(l=>t.jsx("div",{className:"relative bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-4 border border-indigo-200",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:l.name}),t.jsx("p",{className:"text-sm text-gray-600 mt-1 font-mono",children:l.code}),t.jsx("div",{className:"mt-2",children:t.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-white text-indigo-700",children:l.discountType==="amount"?`${l.discountValue.toLocaleString()}원 할인`:`${l.discountValue}% 할인`})})]}),t.jsx("button",{onClick:()=>i(l.code),className:"text-gray-400 hover:text-red-600 transition-colors",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})},l.code)),t.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 flex items-center justify-center hover:border-gray-400 transition-colors",children:t.jsxs("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 flex flex-col items-center",children:[t.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),t.jsx("p",{className:"mt-2 text-sm font-medium",children:"새 쿠폰 추가"})]})})]})}function at(){const[e]=j(ae);return t.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsx("h2",{className:"text-lg font-semibold",children:"쿠폰 관리"})}),t.jsxs("div",{className:"p-6",children:[t.jsx(ct,{}),e&&t.jsx(it,{})]})]})}function lt(){const[e,s]=j(ce),[n]=j(ie),r=N(Q),i=N(oe),a=N(Ze),l=N(Ye),h=()=>{i(!1)},u=o=>{o.preventDefault(),n&&n!=="new"?(l({productId:n,updates:e}),r({message:"상품이 수정되었습니다.",type:"success"})):(a({...e,discounts:e.discounts}),r({message:"상품이 추가되었습니다.",type:"success"})),i(!1)};return t.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:t.jsxs("form",{onSubmit:u,className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900",children:n==="new"?"새 상품 추가":"상품 수정"}),t.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"상품명"}),t.jsx("input",{type:"text",value:e.name,onChange:o=>s({...e,name:o.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"설명"}),t.jsx("input",{type:"text",value:e.description,onChange:o=>s({...e,description:o.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"가격"}),t.jsx("input",{type:"text",value:e.price===0?"":e.price,onChange:o=>{const{value:c}=o.target;(c===""||/^\d+$/.test(c))&&s({...e,price:c===""?0:parseInt(c)})},onBlur:o=>{const{value:c}=o.target;c===""?s({...e,price:0}):parseInt(c)<0&&(r({message:"가격은 0보다 커야 합니다",type:"error"}),s({...e,price:0}))},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",placeholder:"숫자만 입력",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"재고"}),t.jsx("input",{type:"text",value:e.stock===0?"":e.stock,onChange:o=>{const{value:c}=o.target;(c===""||/^\d+$/.test(c))&&s({...e,stock:c===""?0:parseInt(c)})},onBlur:o=>{const{value:c}=o.target;c===""?s({...e,stock:0}):parseInt(c)<0?(r({message:"재고는 0보다 커야 합니다",type:"error"}),s({...e,stock:0})):parseInt(c)>9999&&(r({message:"재고는 9999개를 초과할 수 없습니다",type:"error"}),s({...e,stock:9999}))},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",placeholder:"숫자만 입력",required:!0})]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"할인 정책"}),t.jsxs("div",{className:"space-y-2",children:[e.discounts.map((o,c)=>t.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 p-2 rounded",children:[t.jsx("input",{type:"number",value:o.quantity,onChange:x=>{const m=[...e.discounts];m[c].quantity=parseInt(x.target.value)||0,s({...e,discounts:m})},className:"w-20 px-2 py-1 border rounded",min:"1",placeholder:"수량"}),t.jsx("span",{className:"text-sm",children:"개 이상 구매 시"}),t.jsx("input",{type:"number",value:o.rate*100,onChange:x=>{const m=[...e.discounts];m[c].rate=(parseInt(x.target.value)||0)/100,s({...e,discounts:m})},className:"w-16 px-2 py-1 border rounded",min:"0",max:"100",placeholder:"%"}),t.jsx("span",{className:"text-sm",children:"% 할인"}),t.jsx("button",{type:"button",onClick:()=>{const x=e.discounts.filter((m,b)=>b!==c);s({...e,discounts:x})},className:"text-red-600 hover:text-red-800",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},c)),t.jsx("button",{type:"button",onClick:()=>{s({...e,discounts:[...e.discounts,{quantity:10,rate:.1}]})},className:"text-sm text-indigo-600 hover:text-indigo-800",children:"+ 할인 추가"})]})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{type:"button",onClick:h,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"취소"}),t.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700",children:n==="new"?"추가":"수정"})]})]})})}function dt(){const[e]=j(T),s=N(et),n=N(Q),r=N(oe),i=N(ie),a=N(ce),l=(o,c)=>{if(c){const x=e.find(m=>m.id===c);if(x&&x.stock<=0)return"SOLD OUT"}return`${o.toLocaleString()}원`},h=o=>{i(o.id),a({name:o.name,price:o.price,stock:o.stock,description:o.description||"",discounts:o.discounts||[]}),r(!0)},u=o=>{s(o),n({message:"상품이 삭제되었습니다.",type:"success"})};return t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상품명"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"가격"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"재고"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"설명"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"작업"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(o=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:o.name}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:l(o.price,o.id)}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${o.stock>10?"bg-green-100 text-green-800":o.stock>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[o.stock,"개"]})}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:o.description||"-"}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[t.jsx("button",{onClick:()=>h(o),className:"text-indigo-600 hover:text-indigo-900 mr-3",children:"수정"}),t.jsx("button",{onClick:()=>u(o.id),className:"text-red-600 hover:text-red-900",children:"삭제"})]})]},o.id))})]})})}function ut(){const[e,s]=j(oe),n=N(ie),r=N(ce);return t.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[t.jsx("div",{className:"p-6 border-b border-gray-200",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"상품 목록"}),t.jsx("button",{onClick:()=>{n("new"),r({name:"",price:0,stock:0,description:"",discounts:[]}),s(!0)},className:"px-4 py-2 bg-gray-900 text-white text-sm rounded-md hover:bg-gray-800",children:"새 상품 추가"})]})}),t.jsx(dt,{}),e&&t.jsx(lt,{})]})}function mt(){j(E),j(T);const[e,s]=_.useState("products");return t.jsxs("div",{className:"max-w-6xl mx-auto",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"관리자 대시보드"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"상품과 쿠폰을 관리할 수 있습니다"})]}),t.jsx("div",{className:"border-b border-gray-200 mb-6",children:t.jsxs("nav",{className:"-mb-px flex space-x-8",children:[t.jsx("button",{onClick:()=>s("products"),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${e==="products"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"상품 관리"}),t.jsx("button",{onClick:()=>s("coupons"),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${e==="coupons"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"쿠폰 관리"})]})}),e==="products"?t.jsx(ut,{}):t.jsx(at,{})]})}function xt(e){const{item:s,hasDiscount:n,discountRate:r,itemTotal:i,handleClickQuantity:a,removeFromCart:l}=e;return t.jsxs("div",{className:"border-b pb-3 last:border-b-0",children:[t.jsxs("div",{className:"flex justify-between items-start mb-2",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-900 flex-1",children:s.product.name}),t.jsx("button",{onClick:()=>l(s.product.id),className:"text-gray-400 hover:text-red-500 ml-2",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("button",{onClick:()=>a(s.product.id,s.quantity-1),className:"w-6 h-6 rounded border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:t.jsx("span",{className:"text-xs",children:"−"})}),t.jsx("span",{className:"mx-3 text-sm font-medium w-8 text-center",children:s.quantity}),t.jsx("button",{onClick:()=>a(s.product.id,s.quantity+1),className:"w-6 h-6 rounded border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:t.jsx("span",{className:"text-xs",children:"+"})})]}),t.jsxs("div",{className:"text-right",children:[n&&t.jsxs("span",{className:"text-xs text-red-500 font-medium block",children:["-",r,"%"]}),t.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[Math.round(i).toLocaleString(),"원"]})]})]})]})}function ht(e){const{cart:s,updateQuantity:n,removeFromCart:r,calculateItemTotal:i,addNotification:a}=e,[l]=j(T),h=(u,o)=>{if(o<=0){r(u);return}const c=l.find(m=>m.id===u);if(!c)return;const x=c.stock;if(o>x){a(`재고는 ${x}개까지만 있습니다.`,"error");return}if(typeof n=="function"){const m=n;m.length>=2?m(u,o):m({productId:u,quantity:o})}};return t.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),"장바구니"]}),s.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx("svg",{className:"w-16 h-16 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),t.jsx("p",{className:"text-gray-500 text-sm",children:"장바구니가 비어있습니다"})]}):t.jsx("div",{className:"space-y-3",children:s.map(u=>{const o=i(u),c=u.product.price*u.quantity,x=o<c,m=x?Math.round((1-o/c)*100):0;return t.jsx(xt,{item:u,hasDiscount:x,discountRate:m,itemTotal:o,handleClickQuantity:h,removeFromCart:r},u.product.id)})})]})}function ft({coupons:e,selectedCoupon:s,onCouponSelect:n}){const r=i=>{const a=e.find(l=>l.code===i.target.value);n(a||null)};return t.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"쿠폰 할인"}),t.jsx("button",{className:"text-xs text-blue-600 hover:underline",children:"쿠폰 등록"})]}),e.length>0&&t.jsxs("select",{className:"w-full text-sm border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500",value:s?.code||"",onChange:r,children:[t.jsx("option",{value:"",children:"쿠폰 선택"}),e.map(i=>t.jsxs("option",{value:i.code,children:[i.name," (",i.discountType==="amount"?`${i.discountValue.toLocaleString()}원`:`${i.discountValue}%`,")"]},i.code))]})]})}function pt({totals:e,onCompleteOrder:s}){const n=e.totalBeforeDiscount-e.totalAfterDiscount,r=n>0;return t.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"결제 정보"}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"상품 금액"}),t.jsxs("span",{className:"font-medium",children:[e.totalBeforeDiscount.toLocaleString(),"원"]})]}),r&&t.jsxs("div",{className:"flex justify-between text-red-500",children:[t.jsx("span",{children:"할인 금액"}),t.jsxs("span",{children:["-",n.toLocaleString(),"원"]})]}),t.jsxs("div",{className:"flex justify-between py-2 border-t border-gray-200",children:[t.jsx("span",{className:"font-semibold",children:"결제 예정 금액"}),t.jsxs("span",{className:"font-bold text-lg text-gray-900",children:[e.totalAfterDiscount.toLocaleString(),"원"]})]})]}),t.jsxs("button",{onClick:s,className:"w-full mt-4 py-3 bg-yellow-400 text-gray-900 rounded-md font-medium hover:bg-yellow-500 transition-colors",children:[e.totalAfterDiscount.toLocaleString(),"원 결제하기"]}),t.jsx("div",{className:"mt-3 text-xs text-gray-500 text-center",children:t.jsx("p",{children:"* 실제 결제는 이루어지지 않습니다"})})]})}const gt=(e,s)=>{const{discounts:n}=e.product,{quantity:r}=e,i=n.reduce((l,h)=>r>=h.quantity&&h.rate>l?h.rate:l,0);return s.some(l=>l.quantity>=10)?Math.min(i+.05,.5):i},Ae=(e,s)=>{const{price:n}=e.product,{quantity:r}=e,i=gt(e,s);return Math.round(n*r*(1-i))},ge=(e,s)=>{let n=0,r=0;return e.forEach(i=>{const a=i.product.price*i.quantity;n+=a,r+=Ae(i,e)}),s&&(s.discountType==="amount"?r=Math.max(0,r-s.discountValue):r=Math.round(r*(1-s.discountValue/100))),{totalBeforeDiscount:Math.round(n),totalAfterDiscount:Math.round(r)}},yt=(e,s)=>!(s<1e4&&e.discountType==="percentage");function bt(e){const{addNotification:s}=e,[n]=j(P),[r]=j(E),[i,a]=j(_e),l=N(He),h=N(Ke),u=N(Xe),o=_.useCallback(b=>{if(!b){a(null);return}const w=ge(n).totalAfterDiscount;if(!yt(b,w)){s("percentage 쿠폰은 10,000원 이상 구매 시 사용 가능합니다.","error");return}a(b),s("쿠폰이 적용되었습니다.","success")},[n,s,a]),c=_.useCallback(()=>{const b=`ORD-${Date.now()}`;s(`주문이 완료되었습니다. 주문번호: ${b}`,"success"),u(),a(null)},[s,u]),x=_.useCallback(b=>Ae(b,n),[n]),m=ge(n,i);return t.jsxs("div",{className:"sticky top-24 space-y-4",children:[t.jsx(ht,{cart:n,updateQuantity:(b,w)=>l({productId:b,quantity:w}),removeFromCart:h,calculateItemTotal:x,addNotification:s}),n.length>0&&t.jsxs(t.Fragment,{children:[t.jsx(ft,{coupons:r,selectedCoupon:i,onCouponSelect:o}),t.jsx(pt,{totals:m,onCompleteOrder:c})]})]})}function vt(e){const{product:s,price:n,remainingStock:r,handleAddToCart:i}=e;return t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"aspect-square bg-gray-100 flex items-center justify-center",children:t.jsx("svg",{className:"w-24 h-24 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),s.isRecommended&&t.jsx("span",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded",children:"BEST"}),s.discounts.length>0&&t.jsxs("span",{className:"absolute top-2 left-2 bg-orange-500 text-white text-xs px-2 py-1 rounded",children:["~",Math.max(...s.discounts.map(a=>a.rate))*100,"%"]})]}),t.jsxs("div",{className:"p-4",children:[t.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:s.name}),s.description&&t.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-2",children:s.description}),t.jsxs("div",{className:"mb-3",children:[t.jsx("p",{className:"text-lg font-bold text-gray-900",children:n}),s.discounts.length>0&&t.jsxs("p",{className:"text-xs text-gray-500",children:[s.discounts[0].quantity,"개 이상 구매시 할인 ",s.discounts[0].rate*100,"%"]})]}),t.jsxs("div",{className:"mb-3",children:[r<=5&&r>0&&t.jsxs("p",{className:"text-xs text-red-600 font-medium",children:["품절임박! ",r,"개 남음"]}),r>5&&t.jsxs("p",{className:"text-xs text-gray-500",children:["재고 ",r,"개"]})]}),t.jsx("button",{onClick:()=>i(s),disabled:r<=0,className:`w-full py-2 px-4 rounded-md font-medium transition-colors ${r<=0?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800"}`,children:r<=0?"품절":"장바구니 담기"})]})]})}function jt(e){const{debouncedSearchTerm:s,addNotification:n}=e,[r]=j(T),[i]=j(P),a=N(Ge),l=(o,c)=>{if(c){const x=r.find(m=>m.id===c);if(x&&se(x,i)<=0)return"SOLD OUT"}return`₩${o.toLocaleString()}`},h=o=>{try{a(o),n("장바구니에 담았습니다","success")}catch(c){n(c instanceof Error?c.message:"알 수 없는 오류가 발생했습니다.","error")}},u=s?r.filter(o=>o.name.toLowerCase().includes(s.toLowerCase())||o.description&&o.description.toLowerCase().includes(s.toLowerCase())):r;return t.jsxs("section",{children:[t.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[t.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"전체 상품"}),t.jsxs("div",{className:"text-sm text-gray-600",children:["총 ",r.length,"개 상품"]})]}),u.length===0?t.jsx("div",{className:"text-center py-12",children:t.jsxs("p",{className:"text-gray-500",children:['"',s,'"에 대한 검색 결과가 없습니다.']})}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:u.map(o=>{const c=se(o,i),x=l(o.price,o.id);return t.jsx(vt,{product:o,price:x,remainingStock:c,handleAddToCart:h},o.id)})})]})}function wt(){const[e]=j(Se),[,s]=j(V),n=(r,i="success")=>{const a=Date.now().toString();s(l=>[...l,{id:a,message:r,type:i}])};return t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[t.jsx("div",{className:"lg:col-span-3",children:t.jsx(jt,{debouncedSearchTerm:e,addNotification:n})}),t.jsx("div",{className:"lg:col-span-1",children:t.jsx(bt,{addNotification:n})})]})}const Nt=()=>{j(P);const[e]=j(Ce),[s]=j(V);return t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.length>0&&t.jsx(ot,{}),t.jsx(rt,{}),t.jsx("main",{className:"max-w-7xl mx-auto px-4 py-8",children:e?t.jsx(mt,{}):t.jsx(wt,{})})]})},kt=()=>t.jsx(Oe,{children:t.jsx(Nt,{})});Te.createRoot(document.getElementById("root")).render(t.jsx(ne.StrictMode,{children:t.jsx(kt,{})}));
